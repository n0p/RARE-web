# Example: ppp with packet over tls

## **Topology diagram**

![topology](/img/conn-pckou19.tst.png)

## **Configuration**

**r1:**
```
hostname r1
buggy
!
logging file debug ../binTmp/zzz29r1-log.run
!
crypto rsakey rsa import $v10$TUlJRXBBSUJBQUtDQVFFQXpxVGpPajBmRm5QeFYzNVJuUnMydUJpSTNOaCtHT0F4cWlPVmlia0N1aU9jSGJWYjZLRnFCYlZROWNiNzJnaVc5V2NZV0MwaEltdXdYRnlXOU1JUS9IbEU1U1BSZVdjZTZSeVVFSyszeDdualVjK0RQc0R3R1V5elI5M1EybTNkVFRxTnpVL1RhSTErN3JudnlFWStvZFlZZkxCdlA4ZFNyWURaNmF6QyswRlJwSWlWUEpWRU4rbFVUQnJSNWVpVnh1N3o3Q1MxTmxGbFdzeXBwVWg3Y1REazR0UlVlS1dubTNJcmNzS3d5WXpleGRQelpNdHFVVU1OTjdwU045N1dxZzBNOGJocHA5V3ZUWmY4Nm1ES3h6RFhEUDR4S1VxYXNvQ1JRdVFlb3N1VkZkdEFOVEhqRkxDZ3F2SGFBVXIyN1F0YVcwT21kelVNNXYxK2NDU3did0lEQVFBQkFvSUJBUUN4N2N3eDQxc1hUREhzc2ptMzJ5emNpMU9kUlZRZU96eklVT2Q3dExBaWNuTUVLWnEvemV5cWlacnlaYW1KN1lkK09vejlyNjR1SXlleC80K0RwRzVYMWx0NktjTStrNHBNRW0xemlMbm40YWxZVWlPaUx5TU54YnRCRUQrN05Jb3U2MUlhRExmdCtKZnBHblRhcjVGU2JEU2RlSlh5QnNDcjRKekIxaDMxbEpYYW5sNTZveUovMWREWmYwaWNZY2ZHSzF0TGgyR1VQcHZRRzU0ajNROTdScFN1cGVmOU1lR21Bc1R6L3VkbUpNYlFQWVFyS3VOTFVCSmIrVDdIcUwxVnAwWUlNVVJPamxXSXBGZHBPVjFxYURTVHdrQ2F1N1N3WStKU2xHUjROL2ZBQzhlbzkzVnpSaVJDVEVLcjdGQy9FOU0ycHhpMWZ2aDBsVUV1SlRFQkFvR0JBUFFtM2dhc1hhKzJqeFF5NzB4NEI1VUtDL0tnc0cwVFhIWGxoZ2Z5MWNncFRwdlRjSXk3alc3V2hjcUZBbld1QzljeVdQMllQWUFIeDZSTGt2OVN0WE5vNXRYdTNvWVJzMVRvdlVDZW5oVy9Gc25KbGV4WTA2WEVmSnBXdmMvR3NTNVhpNWZxL2wrNUlOUmppSlRLR0hCVUt4Rlc3c1VKaS9aWjUvVXBndUJCQW9HQkFOaXNEbktkQldqRzllcDhvVE13L0txVVBpZ2Z2STNFRVlyNmRyeU9XWFl3Z3RnL1lsNzVnU1k3c3RVRVJXMlRxeVNiRGcvWVZld2xhUEtKQ2phdXVZZG95OTJSOEVDTkdDbmJaOEF6Q3F3N1VBUEJPSy8yMVhLVEoydFk5ZzFVbDlSSXNFQjY2UHZyT25uUGpWS2tvamtHTC9KTll6RWY0dmRYWSt1ckZHU3ZBb0dCQUx1T05CZDZTQW9ZdXZjd1hhWW51dU5pTVdWMHpiTXRJV1VzS2Zkbk01VXRMa2NFZWJ5U3c0WjI0NVo4OFRQSHZTN1diWWg2Y0J3dlhjMDNoVGdBcUlWOCszOHluZHp1TWc0ek1GYzR3b1pBSWxobk5IVzRrdllQNkF5RVFCSWlON0E2N25DSXhGcHlrK2EwZzVLUllZN0JDY2lyT0lkQzJ6TW5ROHFRMWdwQkFvR0FmNW8wbUFNcFlGOXNERUNCbnVoR3BSN1F6RWlFZnVqdGUrK3RaYlpmc1Y4NGI2cEVnTEpvQU9BL25YdjZkMkh6OUlic2JTQjIyYS9lY3BlS1VGSHVLWFRxT3Y3cmd0aVZWbkZFVk1pNmpGd1I3MlFud2xtWHN2WSt6TldEY3E1VERFNFNucWJEOXppOUkyZThUdU51Tmk4U3BadzF3b1NJNGlteFN1VmlDVGtDZ1lBMjFTOGNZbFliaGNHaU0rcUJna044YkNZTjAxV3FZRFhsN0F6LzVjVFhsZXBFTEl0ZVgwZFArdDBKaVNZeE9qbzlVdnBTT0VvK2UzOVZubmxmeUdsazRmaHE1a210WmppT2dPR3NFV3lUU253WlFONGd2VVN1cFdMb1lrZUszY0tVTDF5S2Q4RGROUjJWY0cxV1VnMTJaMjNRZlVwV3ZhTHovandPV09kaXpRPT0=
!
crypto dsakey dsa import $v10$TUlJQnVRSUJBQUtCZ0RuWUNidmVGTzRsWi93a1BXWTdYWU5oUnZwalJmZytqOUF3UkRxR0YwUVZ6WDBGQjBHZmt0SW9udTFhcG42aVFpTFNMNkFUanI1R2ZycmREQWVJWm93d3p6TGVnQ0tjUnlmVC9GTXpZWEVlYkdEZHBTbDllUDYrQWwwaERtWUg0OEhBMHUxK1F5Y1RMTE80UGVSTHhlYzVpNlgwYjB3UDlKeHJTSjRxck1GYkFoVUEyc1ZOZ2Y0T2YxdzNhYmVobDFLMjRzdTJ1cEVDZ1lBaU9Pb25Qay9qNUs0eno1RldZTkZVRTlWaVN5cjV1OWdpK2JqNzZIR3VjeG1CWk9ybFh1MkhOM0YzdkYrM1IxNVU4Y00xZTVwOTBlQVFHWmtZMXcvbHZzMXJhTzY1RXNPZzFrOFBaSWJ6aHhLUnMvWUZYVGQ5Y0JVL05GRVIyNnNsY0lYWUJPKzU1RUhiMDQ0L1VVK3ppQU1pR1BDYmc3SnRFMFZiZi8wMzFRS0JnQ1NvUWJ4OGNFOFhvMmNLMzUzQ2Z5ZGR2MXBSdWpvMGRvNjk2NHhsemxhRE5oVG4xYk1XaVB4d3d2a0ZIbi9jQ25Va0c2Y29IdUJkVktudDZHaGdYUDMyMDMzSTFqdml6REdQTU9GRmgwVm9DYUxZSmFTVGpBQ2VGa1BuaHdFa2RSQlgraXRKQTcrWGVhODU4VUp4dlFFNHk3Q0hqeXNqbUdZMVdLN3ZVVGMxQWhReUFvTWF1aDRmVFJZQzFSNEl2SFZBN0g1cnVBPT0=
!
crypto ecdsakey ecdsa import $v10$TUhNQ0FRRUVIelhIQ0hLRmJ2SUFXYmhsWWU0TkdRQnR3L0ZwN1l5VHMyVGJWTEVmY3dhZ0J3WUZLNEVFQUFxaFJBTkNBQVE4bC9yWkFydkVlTkhKTE1JT3oyQ29IT0hpMEVmMlVGVDFUWFlsUXNGcXFLd1pGeG5TT29ZQjdJOGdmS2JISHF3TFJ3U2lBZXU5NkhMblZYUTVFaEJo
!
crypto certificate dsa import dsa dsa $v10$TUlJQ1V6Q0NBZytnQXdJQkFnSUVCb1VIY3pBTEJnY3Foa2pPT0FRREJRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05NakV3T0RFM01EZzFOVE14V2hjTk16RXdPREUxTURnMU5UTXhXakFOTVFzd0NRWURWUVFERXdKeU1UQ0NBYlV3Z2dFcUJnY3Foa2pPT0FRQk1JSUJIUUtCZ0RuWUNidmVGTzRsWi93a1BXWTdYWU5oUnZwalJmZytqOUF3UkRxR0YwUVZ6WDBGQjBHZmt0SW9udTFhcG42aVFpTFNMNkFUanI1R2ZycmREQWVJWm93d3p6TGVnQ0tjUnlmVC9GTXpZWEVlYkdEZHBTbDllUDYrQWwwaERtWUg0OEhBMHUxK1F5Y1RMTE80UGVSTHhlYzVpNlgwYjB3UDlKeHJTSjRxck1GYkFoVUEyc1ZOZ2Y0T2YxdzNhYmVobDFLMjRzdTJ1cEVDZ1lBaU9Pb25Qay9qNUs0eno1RldZTkZVRTlWaVN5cjV1OWdpK2JqNzZIR3VjeG1CWk9ybFh1MkhOM0YzdkYrM1IxNVU4Y00xZTVwOTBlQVFHWmtZMXcvbHZzMXJhTzY1RXNPZzFrOFBaSWJ6aHhLUnMvWUZYVGQ5Y0JVL05GRVIyNnNsY0lYWUJPKzU1RUhiMDQ0L1VVK3ppQU1pR1BDYmc3SnRFMFZiZi8wMzFRT0JoQUFDZ1lBa3FFRzhmSEJQRjZObkN0K2R3bjhuWGI5YVVibzZOSGFPdmV1TVpjNVdnellVNTlXekZvajhjTUw1QlI1LzNBcDFKQnVuS0I3Z1hWU3A3ZWhvWUZ6OTl0Tjl5Tlk3NHN3eGp6RGhSWWRGYUFtaTJDV2trNHdBbmhaRDU0Y0JKSFVRVi9vclNRTy9sM212T2ZGQ2NiMEJPTXV3aDQ4ckk1aG1OVml1NzFFM05UQUxCZ2NxaGtqT09BUURCUUFETVFBQU1DMENGUURMYU9zaHY1NW5aS1JMOHhuaTg2UW0wVUU5MUFJVUpxZmNNWkxYb1Bpc0FDUnhRcVAySTJXUysxbz0=
!
crypto certificate ecdsa import ecdsa ecdsa $v10$TUlJQlREQ0JzS0FEQWdFQ0FnUmxMWXkzTUF3R0NDcUdTTTQ5QkFNQ0JRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05NakV3T0RFM01EZzFOVE14V2hjTk16RXdPREUxTURnMU5UTXhXakFOTVFzd0NRWURWUVFERXdKeU1UQlhNQkFHQnlxR1NNNDlBZ0VHQlN1QkJBQUtBME1BQUFROGwvclpBcnZFZU5ISkxNSU96MkNvSE9IaTBFZjJVRlQxVFhZbFFzRnFxS3daRnhuU09vWUI3SThnZktiSEhxd0xSd1NpQWV1OTZITG5WWFE1RWhCaE1Bd0dDQ3FHU000OUJBTUNCUUFEZ1lnQUFEQ0Jnd0lnWStWM0RodnRhY0wxaDFZYW9ERjZJVE9OSW5jcGVDRVhLV0U3S21zdWpNQUNYd29sa3FLQURJTTlWWXBETDlCOGkyWGNPdnVWRmpCMnFLdjlRN1B1aXl3OVVPeFd0NVFzdlpVSTZ4aGN1ZTNseWF4dmZlT0RaOGdTTUtDVXp2am9zUFFOeG0vQm95L1NiMlUvUjY2dVNvMTNFMkxjc3lUWS8wbXJOQUhJRXZpWQ==
!
crypto certificate rsa import rsa rsa $v10$TUlJQ2xqQ0NBWDZnQXdJQkFnSUVUWmFVd3pBTkJna3Foa2lHOXcwQkFRc0ZBREFOTVFzd0NRWURWUVFERXdKeU1UQWVGdzB5TVRBNE1UY3dPRFUxTXpGYUZ3MHpNVEE0TVRVd09EVTFNekZhTUEweEN6QUpCZ05WQkFNVEFuSXhNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXpxVGpPajBmRm5QeFYzNVJuUnMydUJpSTNOaCtHT0F4cWlPVmlia0N1aU9jSGJWYjZLRnFCYlZROWNiNzJnaVc5V2NZV0MwaEltdXdYRnlXOU1JUS9IbEU1U1BSZVdjZTZSeVVFSyszeDdualVjK0RQc0R3R1V5elI5M1EybTNkVFRxTnpVL1RhSTErN3JudnlFWStvZFlZZkxCdlA4ZFNyWURaNmF6QyswRlJwSWlWUEpWRU4rbFVUQnJSNWVpVnh1N3o3Q1MxTmxGbFdzeXBwVWg3Y1REazR0UlVlS1dubTNJcmNzS3d5WXpleGRQelpNdHFVVU1OTjdwU045N1dxZzBNOGJocHA5V3ZUWmY4Nm1ES3h6RFhEUDR4S1VxYXNvQ1JRdVFlb3N1VkZkdEFOVEhqRkxDZ3F2SGFBVXIyN1F0YVcwT21kelVNNXYxK2NDU3did0lEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQWJwQTVvb0lnZ0thcklzbXFreGl3dk9QZzJXWTFLcGRseHV3UVkyUDNMTlZ4aFE0NjJqQ0JJeDdIbE1zQWZIS2dPcDVaZkNSOEQ4dDdOaVBEaSthUGJEdlZPQ2l5dGVoWUUyUlVrd3EvTlBjKzVJM0hjdVJ5S3RmL0NZdlFQZFY3UXA0Sy92dWh3V1IyNzY2cHdlSUpsT3pzWHMwdnBjdGkvbi9hSXpvWEp4WlZYYnNVcDRTQVFETUMxRWpJTmp4bDhsK2FSTUF2R1czZVpLMFQxeWpsRmJUMVZjMWNVRXM1TWlVVDhwb3IwTU5hNUd2THJXaDdzL3Q4ZEpMbnFoYkdsOXBxd1BYcGlWRkl0b1FpRU9RRm56TXliVjBUVVFTdU5VL0MyMjVqNFRhRENsdmJORmhtWVBkQjBwYzNBQ25nbm1jeDhCQVM2a3JNYlNNcDhLQzNK
!
ipv4 pool p4 2.2.2.1 0.0.0.1 254
!
vrf definition tester
 exit
!
vrf definition v1
 rd 1:1
 exit
!
interface loopback0
 no description
 vrf forwarding v1
 ipv4 address 4.4.4.4 255.255.255.255
 no shutdown
 no log-link-change
 exit
!
interface dialer1
 no description
 encapsulation ppp
 ppp ip4cp open
 ppp ip4cp local 2.2.2.0
 vrf forwarding v1
 ipv4 address 2.2.2.0 255.255.255.255
 ipv4 pool p4
 no shutdown
 no log-link-change
 exit
!
interface serial1
 no description
 encapsulation hdlc
 vrf forwarding v1
 ipv4 address 1.1.1.1 255.255.255.0
 ipv6 address 1234::1 ffff::
 no shutdown
 no log-link-change
 exit
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
server telnet tester
 security protocol telnet
 no exec authorization
 no login authentication
 vrf tester
 exit
!
server pckotcp pou
 security protocol tls
 security rsakey rsa
 security dsakey dsa
 security ecdsakey ecdsa
 security rsacert rsa
 security dsacert dsa
 security ecdsacert ecdsa
 clone dialer1
 vrf v1
 exit
!
!
end
```

**r2:**
```
hostname r2
buggy
!
logging file debug ../binTmp/zzz29r2-log.run
!
prefix-list p1
 sequence 10 permit 0.0.0.0/0 ge 0 le 0
 exit
!
vrf definition tester
 exit
!
vrf definition v1
 rd 1:1
 exit
!
interface dialer1
 no description
 encapsulation ppp
 ppp ip4cp open
 ppp ip4cp local 0.0.0.0
 vrf forwarding v1
 ipv4 address 3.3.3.3 255.255.255.128
 ipv4 gateway-prefix p1
 no shutdown
 no log-link-change
 exit
!
interface serial1
 no description
 encapsulation hdlc
 vrf forwarding v1
 ipv4 address 1.1.1.2 255.255.255.0
 ipv6 address 1234::2 ffff::
 no shutdown
 no log-link-change
 exit
!
proxy-profile p1
 security tls
 vrf v1
 exit
!
vpdn pou
 interface dialer1
 proxy p1
 target 1.1.1.1
 vcid 2554
 protocol pckotcp
 exit
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
server telnet tester
 security protocol telnet
 no exec authorization
 no login authentication
 vrf tester
 exit
!
!
end
```
