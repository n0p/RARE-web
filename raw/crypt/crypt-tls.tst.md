# Example: tls test

## **Topology diagram**

![topology](/img/crypt-tls.tst.png)

## **Configuration**

**r1:**
```
hostname r1
buggy
!
logging file debug ../binTmp/zzz88r1-log.run
!
crypto rsakey rsa import $v10$TUlJRW9nSUJBQUtDQVFFQXBOTjdaWWFPOUUxSEEzZ2YyeFpFWi9Yd2Y5NVZnenVXU1hhRDhSVmU0aExoYjIyQkEvSHcrUXVrS29iaTVsN1JNNU0rSTlFYTNKVGtrbFphNHZrY3RCdG1BbklWQTdmMWtpaW1OZTJwTndSZTJsY1JaUDQvZnU1VjhBMzBsc3lXTmZPRVczU1pZL3JGdmNnd3o1cDJJbjZhSEpFdTNYUG9aUFpyR0k4R25lRjJrQ1VrcTdXUENRR3lVNG5ZZjdUbEFHZ0xUMzFSTk1UZUo4eFFQVWFsMEpnc1ZRbmMrR1daTHkzVFhSLzZkUmxyTTNtL2NaY0RLTXdZY3hYV25LVCtPcElMcG9waWpadHVqaG1WRGxEUXlOellLQnhDaHBmZjNqc0JQM2w2Q0MzWFh5cCsxN21QSS9ZRXRUNk9vR1IzSXN5MndZT0RaVGg4dEVsN0k2YXVlUUlEQVFBQkFvSUJBRmQ1ZVNxWGIvVE5zbHR2L0JBTTBEOFFNaFBhamkxNGlUanhzZkpYY2lTdStuOWxjU3dEMGV5S05oVHZ3eW1adHBNVm1NdnZaTDhlTWZSTDZpNDlJUE9nK3RGZmRER21CcWtMODdINU1HM25YdU9uZzY3Q2xEWXNET1c2c2t6NXhOcGJJNnBaeGpKZVcyVnVBaUdiaXdpaGdlNlpTbkx5MmFvRGNURDJiditJVjVQZTBkUVJ0UllpcExmNFFhcnZ4aFFYdnhpbllMYlh4OXVna1dqSjdLWGh1YVp2SDZSNjlEWkFNZTZpVTNzYWx1UFFjRXBrYWx6RzllNzR0NWtyWmlQTVV6UHlOWGdEOU9haGRSUWxtRko5L1ZDdkJaWDVUcmhWK2RDRTRESlMxcmM5UC91YlpqN1UwSmVEbzRIYnRaU3BFOEQycHk4d3FkN3NNNXh5bjRFQ2dZRUF6LzRBSHB1S3V0OTcxcWw3MDhCcnpCOHlZUExkUmJ6Qm1IdUJ2clVmMFZVOC9uamNMQVBpeTYyWDVXY2JNeEptSzd6akZtY0dtTHZlUjJBN3ZnTUxhT1ZGNmRnem9MNEdOemVpdXllV0NDYVF4cVY2SDR4N2pRUU1iUHgxNzlXRDhObUx1d21OUUFWZjFoQUpYQ0lPbkJ5dnRXMi82M1RsQ1ZTWTUzR29HREVDZ1lFQXl0N1o1aDYrZzBtMkxnV2YrKzk2VU0vYThNWjJvQjNhTWtEZzhvUTBQcVEzME85Q0ZnOUdyNDR5d3llUEtPWkh6VHd5VHdTbjYwbjNDTEk4UGZaQWZkS2ovQzJPZkl4bEFhMHlKUUJ5OVVRMUpsUG1hcUZEeHY1anc0eGVoOHdHQWVxa0h4NXBwcmFUeGJMOTlTMmV5eFlGZ2dlaUR3ZTlod2RveDc0cXNNa0NnWUJNN3NXNmpJdnUvVlVBSEthSnQ0WG45YTRid0JscWZ4d1l1NjVORFEvY3pTdUhjTXIzbU9SZHRETVlEbUE0THRrTjJvc2dzVEQyYzU4UFJhQXpjMHJZSE40VVZmMGF1czd2dzZ0MGtIcmxQdWFVSTRjZGZrZ0E2L3R3b0owNi9mNFVxMU1NOXNhQlpMdURJV0ZrNjgvOW5IcTluLys2SnYzRXlyN1g5T2xaTVFLQmdGK0VwK0hTcmU3UTRRY3dQTkI1UkFVU3FNcGZGM0Z5UE04V2Z4T1FyYXlrMDJiN2tBa2s3aW93Y0xRMFJ4S0J3bUxlcWUxTWl1ZWNyc1NZYndiWmtDbnQ2S29PcFJ6OVdYMTlsN09XVDRvdHNEeTRtaSt3ZUdJVVd0S3luN3VlazJHSm9mYkk4Z085eVR2M2Q5MWR1bnR5aGV0Z1BxeUcvM1M1UjF0c3JWc0pBb0dBZThqczIwWlRCYmw2Q2pac3JZV1ZsVzdRNjZ0cU9mUzlFaXVqZkxISDJxQ1JaeWxGa09WZGNNRVlNNEY3YlcvUEZZQnRFZ3pqdFFERG5LdjhIQ0FFVmJMRHd6R01lVUY5K0xiei90VWF4TEJKNmU3UzVnSnN2ZEJLQ2R0ME9kQ3NuZXp5elNwakw2RWs5cGNzUHQ4cm1qdkZMWTUrWjAzb3pjdXlTZ0JJSmFVPQ==
!
crypto dsakey dsa import $v10$TUlJQnVRSUJBQUtCZ0Z2R1Z2b2VZTGxtWEJsOCtkZXRNNDRFNGNnT2xVZkNjdFYyblZlekNmaHdlMFAwZDFxMU1LK2U3aFRLUTV0K1pYT3hxUmVJWWdBY0N3QnU3VDllZjlVUDBZay9QNFdScGhoSVhEOEdnQjJWdTdiWmUvY1ZHNVZMOWxrR2sva3pZVGdWT0Y2bDhWdUEvN2UxUkd0WUovaEZxdDc1cXFXWFRzZzhVaURrdWtsSEFoVUFqMjV5RFFYZlR6QmJoU2R5YkU3aHBpc3BnK0VDZ1lBTXhMMW9IcTRzNXJVRVl1d3NtMm5KbExGb0xqYnJadjZaVk1BTHVVQittZEVXYmdPMENKbGo3cHdZcXdLb2x2U21MTExrLzhObDRONEJlMWNkdENLSHF3UGhtWFZSQktHYTFQK01UY0dyOE5OSHB0QUZsbVgvclRsaEMzRTVlbEtQMW40dHNPWGN3ZG9wYlAyM1BnYUhYeElQOFpnbUk1aGwzSDJRRFZubnVRS0JnQ2FrRUIvUTFnNmlIbmFwVTBxcEVRSFFjOEdKcnR3c0xTZk1PTWZQUFJPdFFPU09PTy9Wa2lkVmFSeVFtY0w3NFR6RFVMbDhOUDZhV2JPS3RicDNLTnJjS1hGaUJZQkVUdjVpQlRNbTJLUkZ4SW90dEcwM2ZkVkZHcnBLUWdKK1BGSFZwTEpWUk9EOHBMWmlubEpnMi83THM0c3YzSnIrbXpqVmZvblR2ZFR0QWhSRWpQU0FSQm10Q1dmMGpMOGlyQmJiZkxhZUt3PT0=
!
crypto ecdsakey ecdsa import $v10$TUhNQ0FRRUVIMzFUbGZaWEZoam5FZm96QUR4NUd3U3RwYVA2dW9GR3BvZitVVnhXTHdXZ0J3WUZLNEVFQUFxaFJBTkNBQVJZdmhaY3ZvSS9qTFRjZzZoMzNkSStwMDA3V2dwT280L3poeHdzOVVKNzNFQXdEcmFQYnFXaVdnSGg4R25KTDVBVUpjbzAvWGFLcnZmSmlEVW9ZcnU5
!
crypto certificate dsa import dsa dsa $v10$TUlJQ1VqQ0NBZytnQXdJQkFnSUVRM0ptY2pBTEJnY3Foa2pPT0FRREJRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05NakV3T0RFM01EZzFPREV4V2hjTk16RXdPREUxTURnMU9ERXhXakFOTVFzd0NRWURWUVFERXdKeU1UQ0NBYlV3Z2dFcUJnY3Foa2pPT0FRQk1JSUJIUUtCZ0Z2R1Z2b2VZTGxtWEJsOCtkZXRNNDRFNGNnT2xVZkNjdFYyblZlekNmaHdlMFAwZDFxMU1LK2U3aFRLUTV0K1pYT3hxUmVJWWdBY0N3QnU3VDllZjlVUDBZay9QNFdScGhoSVhEOEdnQjJWdTdiWmUvY1ZHNVZMOWxrR2sva3pZVGdWT0Y2bDhWdUEvN2UxUkd0WUovaEZxdDc1cXFXWFRzZzhVaURrdWtsSEFoVUFqMjV5RFFYZlR6QmJoU2R5YkU3aHBpc3BnK0VDZ1lBTXhMMW9IcTRzNXJVRVl1d3NtMm5KbExGb0xqYnJadjZaVk1BTHVVQittZEVXYmdPMENKbGo3cHdZcXdLb2x2U21MTExrLzhObDRONEJlMWNkdENLSHF3UGhtWFZSQktHYTFQK01UY0dyOE5OSHB0QUZsbVgvclRsaEMzRTVlbEtQMW40dHNPWGN3ZG9wYlAyM1BnYUhYeElQOFpnbUk1aGwzSDJRRFZubnVRT0JoQUFDZ1lBbXBCQWYwTllPb2g1MnFWTktxUkVCMEhQQmlhN2NMQzBuekRqSHp6MFRyVURrampqdjFaSW5WV2tja0puQysrRTh3MUM1ZkRUK21sbXppclc2ZHlqYTNDbHhZZ1dBUkU3K1lnVXpKdGlrUmNTS0xiUnROMzNWUlJxNlNrSUNmanhSMWFTeVZVVGcvS1MyWXA1U1lOdit5N09MTDl5YS9wczQxWDZKMDczVTdUQUxCZ2NxaGtqT09BUURCUUFETUFBQU1Dd0NGQ1MxUkRBd2pkLzc1c2Rsc1oxSjZsQXJKSGppQWhSdGhXQm02K2VPOWEvNW5qRHExcGc3NWpRRzFRPT0=
!
crypto certificate ecdsa import ecdsa ecdsa $v10$TUlJQlN6Q0JzS0FEQWdFQ0FnUTgwTExRTUF3R0NDcUdTTTQ5QkFNQ0JRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05NakV3T0RFM01EZzFPREV4V2hjTk16RXdPREUxTURnMU9ERXhXakFOTVFzd0NRWURWUVFERXdKeU1UQlhNQkFHQnlxR1NNNDlBZ0VHQlN1QkJBQUtBME1BQUFSWXZoWmN2b0kvakxUY2c2aDMzZEkrcDAwN1dncE9vNC96aHh3czlVSjczRUF3RHJhUGJxV2lXZ0hoOEduSkw1QVVKY28wL1hhS3J2ZkppRFVvWXJ1OU1Bd0dDQ3FHU000OUJBTUNCUUFEZ1ljQUFEQ0JnZ0lnQU5vaTdDRlNKdHBlcHlXSzNzV1h0NW1NWmF3ZFBYRkpWQUhFSHova0Fka0NYbEYycGxzbmRiMlNSTllkTEw2elNJSlJ3SUFYUzVBdXNzWXlESGIrR2d4eCsrTWxGM3hXbXk0Z3QzakJqaWsrYWxrTTZ5a2l4SXM2dUMwRWoxWWtrZUZib2JQeUhXSzVTYzVKYUl3QXZvYTNDeE5ZTXZEc3JZK1VqUXl6UFNBPQ==
!
crypto certificate rsa import rsa rsa $v10$TUlJQ2xqQ0NBWDZnQXdJQkFnSUVLYmpjc3pBTkJna3Foa2lHOXcwQkFRc0ZBREFOTVFzd0NRWURWUVFERXdKeU1UQWVGdzB5TVRBNE1UY3dPRFU0TVRGYUZ3MHpNVEE0TVRVd09EVTRNVEZhTUEweEN6QUpCZ05WQkFNVEFuSXhNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXBOTjdaWWFPOUUxSEEzZ2YyeFpFWi9Yd2Y5NVZnenVXU1hhRDhSVmU0aExoYjIyQkEvSHcrUXVrS29iaTVsN1JNNU0rSTlFYTNKVGtrbFphNHZrY3RCdG1BbklWQTdmMWtpaW1OZTJwTndSZTJsY1JaUDQvZnU1VjhBMzBsc3lXTmZPRVczU1pZL3JGdmNnd3o1cDJJbjZhSEpFdTNYUG9aUFpyR0k4R25lRjJrQ1VrcTdXUENRR3lVNG5ZZjdUbEFHZ0xUMzFSTk1UZUo4eFFQVWFsMEpnc1ZRbmMrR1daTHkzVFhSLzZkUmxyTTNtL2NaY0RLTXdZY3hYV25LVCtPcElMcG9waWpadHVqaG1WRGxEUXlOellLQnhDaHBmZjNqc0JQM2w2Q0MzWFh5cCsxN21QSS9ZRXRUNk9vR1IzSXN5MndZT0RaVGg4dEVsN0k2YXVlUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQXZITS9TWCt5TWR0YW1zYVcrdFI2bENKVkNTSDhwWEQ0WjY0djN3WWlLbzA1bEVnYjZ5ZTNJYkVOcnJqOUtqZktwM2REUzhhNURrekt1bDBKaG1KL3JoRTQ5YnRlVTJrNlNrZlNzVTJ3Rk82QndvZGF3TytWY0E0eDdKWGExMXkzTWxrN2ExNDF6ejcwWnFCelFyNjJiVGhMS3Q5SUJPM29CNFNsMTFoUlIwMXBSREYyTnQwZUVhWkRDY2FKQmNleUwzODVsdVhlVTE0cUZDL2RhRzNUazE5QUp0TDdiNjFhc2dPMkdrRHV2TTBkTE5IQnA3UHRuWU1VdkdURndlMHM2L2FManV3VzY3NDB1YW5OeHZTa0hGK21VSGFndjRMa1ZNSHR2QjVzRnh1SCthb3dkSGsrUkdnSHNmRU9yMk5ub0p0WVpVTlpUeVVNUndycXFqTTlC
!
vrf definition tester
 exit
!
vrf definition v1
 rd 1:1
 exit
!
interface loopback0
 no description
 vrf forwarding v1
 ipv4 address 2.2.2.2 255.255.255.255
 no shutdown
 no log-link-change
 exit
!
interface ethernet1
 no description
 vrf forwarding v1
 ipv4 address 1.1.1.1 255.255.255.0
 ipv6 address 1234::1 ffff::
 no shutdown
 no log-link-change
 exit
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
server telnet tel
 security protocol tls
 security rsakey rsa
 security dsakey dsa
 security ecdsakey ecdsa
 security rsacert rsa
 security dsacert dsa
 security ecdsacert ecdsa
 port 666
 no exec authorization
 no login authentication
 vrf v1
 exit
!
server telnet tester
 security protocol telnet
 no exec authorization
 no login authentication
 vrf tester
 exit
!
!
end
```

**r2:**
```
hostname r2
buggy
!
logging file debug ../binTmp/zzz88r2-log.run
!
vrf definition tester
 exit
!
vrf definition v1
 rd 1:1
 exit
!
interface ethernet1
 no description
 vrf forwarding v1
 ipv4 address 1.1.1.2 255.255.255.0
 ipv6 address 1234::2 ffff::
 no shutdown
 no log-link-change
 exit
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
server telnet tester
 security protocol telnet
 no exec authorization
 no login authentication
 vrf tester
 exit
!
!
end
```
